{% extends 'layout.html.twig' %}



{% block stylesheets %}
	{# parent() }#}
  	{% stylesheets '@css_datatables' %}
      	<link rel="stylesheet" href="{{ asset_url }}" /></link>
  	{% endstylesheets %}
{% endblock %}

{% block javascripts %}
	{# parent() #}
    {% javascripts '@js_datatables'%}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}

{% block body %}
	<style type="text/css">
		@media (min-width: 768px) {
		  .modal-xl {
		    width: 95%;
		    max-width:1600px;
		  }
		}

		.select2-selection--multiple { max-height: 10rem; overflow-y: auto }

		.file-preview {
			max-height: 371px;
			height: 370px;
			background-color: #fff;
			display: inline-block;
			overflow-y: auto;
		}

		.scrollable-div{
			min-height: 39px;
			max-height: 40px;
			overflow-y: auto;
			/*background: #fff;*/
			border: 1px solid #ccc;
		}

		.div-Preview{
			max-height: 194px;
			height: 194px;
			padding-left: 10px;
			padding-right: 10px;
			background-color: #fff;	
			overflow-y: scroll;
		}

		#proyectosBusqueda .modal-body{
			height: 600px;
			max-height: 600px;
		}

		.text-area-caratula{
			height: 370px!important;
		}

		#nuevoExpediente{
			z-index: 10000;
		}
			
		#respuestaInforme{
			z-index: 10000;
		}	
				
		#numeroExterno{
			z-index: 15000;
		}
		
		#modalSesion{
			z-index: 15000;
		}
		
		#kvFileinputModal{
			z-index: 15000;
		}

		.tab{
			height: 545px;
			max-height:545px;
			overflow-y: auto; 
		}
		
		.tab-active{
			/* font-style: oblique;*/
			font-weight: bold;
			color: #0000ff;
			padding-left: 10px;
		}
		
		.tab-active::before{
			content: "- ";
			font-weight: bold;
		}
		
		.toggle-on.btn{
			line-height: 22.5px!important;
		}
		.toggle-off.btn{
			line-height: 22.5px!important;
		}
					
		table {
            table-layout:fixed;
            width:100%;
            word-wrap:break-word;
        }
                      
        .table-fixed thead, .table-fixed tbody, .table-fixed tr, 
        .table-fixed td, .table-fixed th { 
        	display: block; 
        }
        .table-fixed tr:after {
            content: ' ';
            display: block;
            visibility: hidden;
            clear: both;
        }
        .table-fixed thead th {
            height: 30px;
        }
        .table-fixed tbody {
            height: 70px;
            overflow-y: auto;
        }
      	.table-fixed tbody tr td, .table-fixed thead th {
            width: 16.6%;
            float: left;
        }
        
        .col-nopadding {
           padding: 0 !important;
           margin: 0 !important;
        }
              
	</style>
	<script type="text/javascript">

		var archivosASubir=[];
	
		wysihtml5.dom.getPastedHtml = function(event) {
    		var html;
    		if (event.clipboardData) {
    			html = event.clipboardData.getData('text/plain');
		  	}
		  	return html;
		};

		function criterio(){
			var tipo=$("#selBusqueda").val();
			return ((tipo=="todo")?"0":$("#"+tipo).val());	
		}
		function tipoCriterio(){
			return $("#selBusqueda").val();
		}
		
		function mostrarOrigenParaNuevo(mostrar){

			switch(parseInt(mostrar)){
			
				case 3:
						$(".ente-externo").addClass('hidden');
						$(".proyecto-concejales").addClass('hidden');
						$(".expediente-particular").removeClass('hidden');
						$("#apellidosParticular").val('');
						$("#nombresParticular").val('');
						$("#documentoParticular").val('');
						break;
				case 4:
						$(".proyecto-concejales").addClass('hidden');
						$(".expediente-particular").addClass('hidden');
						$(".ente-externo").removeClass('hidden');
						$("#tabla-numeros > tbody").html("");
						$("#selOrigen").val(0);
						break;
				case 0:		
				case 5:
				case 8:
						$(".expediente-particular").addClass('hidden');
						$(".ente-externo").addClass('hidden');
						$(".proyecto-concejales").addClass('hidden');
						break;
				default:
						$(".expediente-particular").addClass('hidden');
						$(".ente-externo").addClass('hidden');
						$(".proyecto-concejales").removeClass('hidden');
						break;
			};
		}
		
		function mostrarOrigenParaEdicion(mostrar){

			switch(parseInt(mostrar)){
			
				case 3:
						$(".ente-externo").addClass('hidden');
						$(".proyecto-concejales").addClass('hidden');
						$(".expediente-particular").removeClass('hidden');
						$("#apellidosParticularMod").val('');
						$("#nombresParticularMod").val('');
						$("#documentoParticularMod").val('');
						break;
				case 4:
						$(".proyecto-concejales").addClass('hidden');
						$(".expediente-particular").addClass('hidden');
						$(".ente-externo").removeClass('hidden');
						$("#tabla-numeros-mod > tbody").html("");
						$("#selOrigenMod").val(0);
						break;
				case 0:		
				case 5:
				case 8:
						$(".expediente-particular").addClass('hidden');
						$(".ente-externo").addClass('hidden');
						$(".proyecto-concejales").addClass('hidden');
						break;
				default:
						$(".expediente-particular").addClass('hidden');
						$(".ente-externo").addClass('hidden');
						$(".proyecto-concejales").removeClass('hidden');
						break;
			};
		}
			
		function mostrarTiposPara(mostrar){
			if (mostrar=="no-proyectos"){
				$(".opcion-P").addClass("hidden");
				$(".opcion-I").removeClass("hidden");
				$(".opcion-W").removeClass("hidden");
				$(".opcion-D").removeClass("hidden");
			}
			else{
				if(mostrar=="proyectos"){
					$(".opcion-P").removeClass("hidden");
					$(".opcion-I").addClass("hidden");
					$(".opcion-W").addClass("hidden");
					$(".opcion-D").addClass("hidden");
				}
				else{
					$(".opcion-P").removeClass("hidden");
					$(".opcion-I").removeClass("hidden");
					$(".opcion-W").removeClass("hidden");
					$(".opcion-D").removeClass("hidden");
				}
			}
		}

		function habilitar(nombre){
			$(".tab").addClass("hidden");
			$(".selectable").removeClass("tab-active");
			
			$("#"+nombre).removeClass("hidden");
			$("#link-"+nombre).addClass("tab-active");
			$("#link-"+nombre).blur();
			
		}

		function traerIdParaMovimientos(tipoMovimiento){
			return $("#"+tipoMovimiento).find('input[name="idExpediente"]').val();
		}

		function abrirModalExternos(modal,tabla){
			$("#numeroExterno").find('input[name="idModal"]').val(modal);
			$("#numeroExterno").find('input[name="tabla-destino"]').val(tabla);
    		$("#numeroExterno").modal('show');
		};

		function validarFolios(control){
			
			var valorControl=$(control).val();
			var idControl=$(control).attr("id");
			var minimoValor=$(control).attr("min");
			
			if (!$.isNumeric(valorControl)){
				toastr.error("El contenido ingresado en folios del expediente " +idControl+ " no es numérico");
				setTimeout(function(){
					   $("#"+idControl).select();
				},10);
			}
			else {
					if(valorControl<minimoValor){	
						toastr.error("El contenido ingresado en folios del expediente " +idControl+ " es menor al minimo");
						setTimeout(function(){
							   $("#"+idControl).select();
						},10);
					}
			}
		}

		function actualizarSesiones(control,valorSeleccionado){

			$.ajax({
				type:'Get',
				dataType: 'json	',
				url:'{{ app.request.getBaseURL() }}'+'/api/session/getLastByType',
				success: function(data){
					$(control).html('');
					var html='<option value="0">Seleccione Sesion</option>'
					$.each(data, function(index,sesion){
						html+='<option value="'+sesion.id+'" '+
							  ((valorSeleccionado==sesion.id)?'selected':'') +'>'+sesion.fecha_formateada+'-('+
							 sesion.tipo_sesion.abreviacion+')</option>';
					});
					$(control).html(html);    			
				},
				error: function(jqXHR,textStatus,errorThrown ){
					toastr.error(jqXHR.responseText);
				}
	      	});
		}

		$(document).ready(function () {
			
			var tablaProyectos;

			var tablaGiros;

			var tablaInformes;
			
		    var tabla=$('#registroExpediente').DataTable({
		    			  "language": {
				              "infoEmpty": "Sin registros para mostrar",
				              "paginate": {
						          	"last": "Ultima Página",
						          	"first": "Primer página",
						          	"next": "Siguiente",
						          	"previous": "Anterior"
						       },
						       "search":"Búsqueda rápida",
						       "emptyTable": "Sin Datos",
						       "lengthMenu": 'Registros Listados <select class="form-control input-sm">'+
								             '<option value="10">10</option>'+
								             '<option value="20">20</option>'+
								             '<option value="30">30</option>'+
								             '<option value="40">40</option>'+
								             '<option value="50">50</option>'+
								             '<option value="-1">Todos</option>'+
								             '</select>',
								"loadingRecords": "Espere...cargando datos",
								"processing": "Procesando...",
								"sInfo": "Mostrando  _START_ a _END_ de _TOTAL_ registros",

			          	  },
					      "processing": false,
					      "ajax": {
							        "url": "api/expediente/getByCriteria/"+tipoCriterio()+"/"+criterio(),
			            			"dataSrc": '',
							    },
						  "columnDefs": [
								            {
								                "targets": [ 0 ],
								                "visible": false,
								                "searchable": false
								            },
								            {
									            "targets": [ 1 ],
									            "data": null,
									            "orderable":false,
									            "render": function(data, type, row){
										            var html="<div class='btn-group'>";
											        html+="<button type='button' title='Giros' class='btn btn-info btn-xs btn-giros' data-toggle='modal' data-target='#giros'><span class='glyphicon glyphicon-refresh'></span></button>";
											        html+="<button type='button' title='Informes' class='btn btn-info btn-xs btn-informes' data-toggle='modal' data-target='#informes'><span class='glyphicon glyphicon-list-alt'></span></button>";
													html+="</div>";
									            	return html;
									            }
									        },
									        {
									            "targets": [ 2 ],
									            "data": "numero_completo",
									            "orderable":true,
									            "render": function(data, type, row){
										            var html="";
										            if('{{ EXP_EDIT is defined}}')
									            		html+="<button type='button'title='Editar expediente' class='btn btn-primary btn-xs btn-editar ' data-toggle='modal' data-target='#modificacionExpediente'><span class='glyphicon glyphicon-pencil'></span></button> ";
									            		html+=data
									            	return html;
									            }
									        },
								            {
									            "targets": [ 6 ],
									            "data": 'oficina_actual',
									            "orderable":true,
									            "render": function(data, type, row){
									            	var html="";
									            	if(data=="COMISIONES" && row.lista_comisiones_asignadas.length>0){
											        	html= "<span style='color:#367fa9' class='glyphicon glyphicon-info-sign' title='"
													              +row.lista_comisiones_asignadas
													              +"'></span>  "+data;
									            	}
													else{             
        									            	if (("{{ app.user.rol.oficina is null}}" || "{{ app.user.rol.oficina.id }}"== "9" ) 
                									            	&& row.oficina_actual_externa && '{{ EXP_RETURN is defined}}'){
        	    												html+="<button type='button' title='Retornar a HCD' class='btn btn-primary btn-xs btn-retorno'"+
        	    													  " data-toggle='modal' data-target='#retornoExterno'>" +
        	    						             		  	  	  "<span class='glyphicon glyphicon-repeat'></span></button>  "+data;
        									            	}
        	    						             		else html=data;
														}
									            	return html;
									            }
									        },
								            {
									            "targets": [ 7 ],
									            "data": 'caratula_muestra',
									            "orderable":true,
									            "render": function(data, type, row){
										            var html="";
									            	html+="<span title='"+row.caratula_sin_html+"'>"+data+"</span>";
									            	 if ('{{EXP_DOWNLOAD is defined}}')
												        	html+="<button type='button' title='Descargar Documento' class='btn btn-info btn-xs btn-descargar'><span class='glyphicon glyphicon-save-file'></span></button>";
									            	return html;
									            }
									        } 
									       
						  ],
					      "columns": [
					      		{ "data": "id" },
					      		{ "data": "null","width":"7%"},
					      		{ "data": "numero_completo","width":"10%"},
					            { "data": "tipo_expediente","width":"8%" },
					            { "data": "fecha_creacion_formateada","width":"8%" },
					            { "data": "fecha_modificacion_formateada","width":"8%" },
					            { "data": "oficina_actual","width":"25%" },
					            { "data": "caratula_muestra", "width": "34%"},
					        ],
					      "autoWidth":false,
					      "paging": true,
					      "lengthChange": true,
					      "searching": true,
					      "ordering": true,
					      "info": true,
					      "autoWidth": false,
				});
		    
			//EVENTO BOTÓN DESCARGAR EXPEDIENTE
		    $('#registroExpediente tbody').on( 'click', '.btn-descargar', function () {
		        var data = tabla.row( $(this).parents('tr') ).data();
		        window.location.href='{{ app.request.getBaseURL() }}'+
		        					 '/imprimir?tipoDocumento=expediente&id='+
		        					  data[ "id" ];
		    } );

			//EVENTO BOTÓN RETORNO EXPEDIENTE
		    $('#registroExpediente tbody').on( 'click', '.btn-retorno', function () {
		        var data = tabla.row( $(this).parents('tr') ).data();
		        $("#retornoExterno").find('input[name="idExpediente"]').val(data[ "id" ]);
		        var html="<div class='form-group'>"+
			        	 "<label for='foliosRetorno'>Folios Actuales</label>" +
			        	 "<input type='number' class='form-control text-center es-numero' min='"+data[ "folios" ]+
			        	 "' onblur='validarFolios(this);'" +
				    	 "id='foliosRetorno' name='foliosRetorno' value='"+data[ "folios" ]+"'>"+
				    	 "</div>";
				$("#retornoExterno").find('div[id="col-folios"]').html(html);
				$("#retornoExterno").find('legend[id="leyenda-retorno"]').html("Exp.: " + data[ "numero_completo" ]);
		    } );

			//EVENTO CERRAR MODAL RETORNO
		    $('#retornoExterno').on('hidden.bs.modal', function () {
		    	$("#retornoExterno").find('input[name="idExpediente"]').val("");
		    	$("#retornoExterno").find('input[name="fechaRetorno"]').val("");
			});

			//BOTÓN GUARDAR RETORNO
			$("#btn-retorno-hcd").click(function(){

				$("#btn-retorno-hcd").prop("disabled",true);
				var idExpediente=$("#retornoExterno").find('input[name="idExpediente"]').val();
				var folios=$("#retornoExterno").find('input[name="foliosRetorno"]').val();
				var fecha=$("#retornoExterno").find('input[name="fechaRetorno"]').val();
				var numeroRemito=$("#retornoExterno").find('input[name="numeroRemitoRetorno"]').val();
				
				var formData=new FormData();

				var validacion='';

				formData.append('idExpediente',idExpediente);
	            	
				formData.append('folios',folios);
	            validacion+=((folios=='')?'<li>Debe indicar la cantidad de folios</li>':'');
	              	
	            formData.append('fecha',fecha);
              	validacion+=((fecha=='')
                      		  ?'<li>Debe indicar la fecha de recepción</li>':'');

      		  	formData.append('numeroRemito',numeroRemito);
      		  	validacion+=((numeroRemito.length==0)
      	      		  		  ?'<li>Debe indicar un numero de remito</li>':'');
					
		            if (validacion.length>0) 
					{
						validacion=((validacion.length>0)?'<strong>Validacion de Datos</strong><br><ul>'+
									validacion+'</ul>':'');
						toastr.error(validacion);
						$(this).prop("disabled", false);
						return false;
					}
					else{ 
        				$.ajax({
        	                async: true,
        	                url: '{{ app.request.getBaseURL() }}'+'/setRetornoExterno',
        	                data: formData,
        	                contentType: false,
        	                cache: false,
    		                processData: false,
        	                type:  'POST',
                        success: function(data) {
                            toastr.success(data);
        					tabla.ajax.reload();
        					$("#retornoExterno").modal('hide');
                        	},
                        complete:function(){
                        	$("#btn-retorno-hcd").prop("disabled", false);
                        },
                        error: function(jqXHR,textStatus,errorThrown ){
        					toastr.error(jqXHR.responseText);
        					}
                    	});
					}
			});
		    
// 			MODIFICAR EXPEDIENTE
// 				$('#registroExpediente tbody').on( 'click', '.btn-detalle', function () {
// 		        var data = tabla.row( $(this).parents('tr') ).data();
// 		        $("#revistaExpediente").find('input[name="id"]').val(data[ "id" ]);
// 		    } );

// 		    EVENTO ABRIR MODAL MODIFICAR EXPEDIENTE
// 			$('#revistaExpediente').on('show.bs.modal', function () {

// 		    	var id= $("#revistaExpediente").find('input[name="id"]').val();

// 		    	Obtención de los datos del select2 -------------------------------------

// 		    	var select2_data=[];

// 		    	$.ajax({
// 					type:'get',
// 					dataType: 'json	',
//					url:"{{ app.request.getBaseURL() }}/api/legislador/getAll",
// 					success: function(data){
// 					    $.each(data, function(index,autor){
// 					    	var autorAux={'id':autor.id, 'text':autor.nombre_completo};
// 					    	select2_data.push(autorAux);
// 					     });
						
// 					},
// 					error: function(jqXHR,textStatus,errorThrown ){
// 						var response=JSON.parse(jqXHR.responseText)
// 						toastr.error(response.throwCause);
// 					}
// 				});

// 		    	Obtención de los datos del expediente a modificar ------------------------

// 		    	$.ajax({
// 					type:'Get',
// 					dataType: 'json	',
//					url:"{{ app.request.getBaseURL() }}/api/expediente/getOne/"+id,
// 					success: function(data){

// 						$("#tipoExpedientePrev").val(data.tipo_expediente.tipo_expediente +
// 													 '-('+data.tipo_expediente.letra+')');
// 						$("#numeroExpedientePrev").val(data.numero_expediente);
// 					    $("#caratulaPrev").html(data.caratula);
					 	
// 					 	selección en la grilla de los items almacenados

// 					    var autores=data.proyecto.autores;
// 					    var selected=[];
// 					    $("#selAutoresPrev").select2({tags: select2_data, tokenSeparators: [',']});
// 					    $.each(autores, function(index,autor){
// 					    	selected.push(autor.id);
// 					     });
// 					    $("#selAutoresPrev").val(selected).change();
// 					    var select2=$("#revistaExpediente").find('.select2')
// 					    select2.prepend('<div class="disabled-select"></div>');

// 					    var config=[];
// 					    $.each(data.lista_imagenes, function(index,imagen){
// 					    	config.push(imagen.image_config);
// 					    });
					    
// 					    recuperacion de los archivos subidos
// 					    $("#input-file-Prev").fileinput({
// 				    		language: "es",
// 			                initialPreview: data.rutas_web_expediente,
// 			                showUpload: false,
// 			                showRemove: false,
// 			                showBrowse: false,
// 			                initialPreviewAsData: false,
// 			                initialPreviewConfig:config,
// 			                overwriteInitial: false,
// 			                maxFileSize: 10240,
			                
// 			                initialCaption: "Archivos Expediente " + data.numero_expediente
			                
// 			            });		    			
// 					},
// 					error: function(jqXHR,textStatus,errorThrown ){
// 						var response=JSON.parse(jqXHR.responseText)
// 						toastr.error(response.throwCause);
// 					}
// 		      	});
// 			});

// 			$('#revistaExpediente').on('hidden.bs.modal', function () {
// 				$('#input-file-Prev').fileinput('destroy');
// 				$("#selAutoresPrev").empty().change();
// 			});	
			
			//---------------------------------------------------------------------------------------------------------------
			//---------------------------------------NUMERO EXPEDIENTE EXTERNO-----------------------------------------------
			//---------------------------------------------------------------------------------------------------------------
						
			 $('#tabla-numeros tbody').on( 'click', '.btn-eliminar-numero', function () {
				 debugger;
		        $(this).parents('tr').remove()
		     });

			 $('#tabla-numeros-mod tbody').on( 'click', '.btn-eliminar-numero-mod', function () {
				 debugger;
		        $(this).parents('tr').remove()
		     });

			 $('#numeroExterno').on('show.bs.modal', function () {

				$("#numeroExterno").find('input[name="idModal"]').val("");
		    	$("#numeroExterno").find('input[name="enteOrigen"]').val("");
	    		$("#numeroExterno").find('input[name="numeroOrigen"]').val("");
	    		$("#numeroExterno").find('input[name="letraOrigen"]').val("");
	    		$("#numeroExterno").find('input[name="añoOrigen"]').val("");
	    		$("#numeroExterno").find('input[name="foliosOrigen"]').val("");
	    		$("#numeroExterno").find('input[name="cuerpos"]').val("");
					 
			 });
			 
			 $("#btn-agregar-numero").click(function(){
				
				var tabla=$("#numeroExterno").find('input[name="tabla-destino"]').val();
				var idModal=$("#numeroExterno").find('input[name="idModal"]').val();
		    	var ente=$("#numeroExterno").find('input[name="enteOrigen"]').val();
	    		var numero=$("#numeroExterno").find('input[name="numeroOrigen"]').val();
	    		var letra=$("#numeroExterno").find('input[name="letraOrigen"]').val();
	    		var año=$("#numeroExterno").find('input[name="añoOrigen"]').val();
	    		var folios=$("#numeroExterno").find('input[name="foliosOrigen"]').val();
	    		var cuerpos=$("#numeroExterno").find('input[name="cuerpos"]').val();
	    		var ingresado=false

	    		$("#"+tabla+" > tbody > tr").each(function(){
					if ($(this).find("td:eq(0)").text()==ente &&
						$(this).find("td:eq(1)").text()==numero &&
						$(this).find("td:eq(2)").text().toLowerCase()==letra.toLowerCase() &&
						$(this).find("td:eq(3)").text()==año)

					ingresado=true;
		    	});

		    	if (ingresado){
			    	toastr.error("El número ya se encuentra ingresado");
		    	}
		    	else{
        				var html="<tr><td style='width:15%'>"+ente+"</td><td style='width:20%'>"+numero+"</td>"+
        						 "<td style='width:10%''>"+letra+"</td><td style='width:15%''>"+año+"</td>"+ 
        						 "<td style='width:15%'>"+folios+"</td><td style='width:15%''>"+cuerpos+"</td>"+
        						 "<td style='width:10%''><button type='button' class='btn btn-danger btn-xs "+
        						 	((tabla=="tabla-numeros-mod")?"btn-eliminar-numero-mod":"btn-eliminar-numero")+"'>"+
        					 	 "<span class='glyphicon glyphicon-remove'/></button></td></tr>";
        				
        	    		$("#"+tabla+" > tbody").append(html);
        	    		$("#numeroExterno").modal('hide');
		    	}
			}); 
			
			//---------------------------------------------------------------------------------------------------------------
			//---------------------------------------EDICIÓN DEL EXPEDIENTE--------------------------------------------------
			//---------------------------------------------------------------------------------------------------------------

			//EVENTO BOTON EDITAR EXPEDIENTE EN GRILLA
		    $('#registroExpediente tbody').on( 'click', '.btn-editar', function () {
		        var data = tabla.row( $(this).parents('tr') ).data();
		        $("#modificacionExpediente").find('input[name="id"]').val(data[ "id" ]);
		    } );

		    //EVENTO ABRIR MODAL MODIFICAR EXPEDIENTE
			$('#modificacionExpediente').on('show.bs.modal', function () {

		    	var id= $("#modificacionExpediente").find('input[name="id"]').val();

		    	//Obtención de los datos del expediente a modificar -----------------

		    	$.ajax({
					type:'Get',
					dataType: 'json	',
					url:'{{ app.request.getBaseURL() }}'+'/api/expediente/getOne/'+id,
					success: function(data){

						var tipoExpediente=data.tipo_expediente;
						$("#selTipoExpedienteMod").val(tipoExpediente);
						mostrarOrigenParaEdicion(tipoExpediente);
						$("#numeroExpedienteMod").val(data.numero_expediente);
						$("#caratulaMod").data("wysihtml5").editor.setValue(data.caratula);
						$("#foliosMod").val(data.folios);
						$("#numerosancionMod").val(data.numero_sancion);
						$("#añoIngresoMod").val(data.año);
						debugger;
						actualizarSesiones($("#selSesionMod"),data.sesion);

						if(data.proyecto!=0){
							$("#selTipoExpedienteMod").prop( "disabled", true );
							$("#concejalesMod").html(data.lista_autores);
							mostrarTiposPara("proyectos");
						}
						else{
							$("#selTipoExpedienteMod").prop( "disabled", false );
							mostrarTiposPara("no-proyectos");
						}
	
						if (tipoExpediente==3 && data.demandante_id!=0){
    						$("#documentoParticularMod").val(data.demandante_documento);
    						$("#apellidosParticularMod").val(data.demandante_apellidos);
    						$("#nombresParticularMod").val(data.demandante_nombres);
						}
					    
						if (tipoExpediente==4 && data.origen_id!=0){
							$("#selOrigenMod").val(data.origen_externo_id);
							var numeros=data.origen_numeracion;
							var html='';
							$.each(numeros,function(index,numero){
								html+="<tr><td style='width:15%'>"+numero.ente+"</td><td style='width:20%'>"+numero.numero+"</td>"+
									  "<td style='width:10%'>"+numero.letra+"</td><td style='width:15%'>"+numero.año+"</td>"+
									  "<td style='width:15%'>"+numero.folios+"</td><td style='width:15%'>"+numero.cuerpos+"</td>"+
									  "<td style='width:10%'><button type='button' class='btn btn-danger btn-xs btn-eliminar-numero-mod'>"+
							 	 	  "<span class='glyphicon glyphicon-remove'/></button></td></tr>";
							});
							$("#tabla-numeros-mod > tbody").append(html);
						}

					    var config=[];
					    $.each(data.lista_imagenes, function(index,imagen){
					    	config.push(imagen.image_config);
					    });

					    //recuperacion de los archivos subidos
					    $("#input-file-Mod").fileinput({
				    		language: "es",
			                initialPreview: data.rutas_web_expediente,
			                showUpload: false,
			                initialPreviewAsData: true,
			                initialPreviewConfig:config,			                
			                overwriteInitial: false,
			                deleteUrl:'{{ app.request.getBaseURL() }}'+'/api/expediente/removeArchivo',
			                maxFileSize: 10240,
			                
			                initialCaption: "Archivos Expediente " + data.numero_expediente
			                
			            });		    			
					},
					error: function(jqXHR,textStatus,errorThrown ){
						toastr.error(jqXHR.responseText);
					}
		      	});
			});

			//EVENTO CERRAR MODAL MODIFICAR EXPEDIENTE
			$('#modificacionExpediente').on('hidden.bs.modal', function () {
				$('#input-file-Mod').fileinput('destroy');
				archivosASubir.length=0;	
			});

			//GUARDAR MODIFICACION DEL EXPEDIENTE
			$("#modificacion").on('submit',function(e){

				e.preventDefault();
				$("#btn-Modificacion-expediente").prop("disabled",true);
             	var form=$(e.target);
              	var formData=new FormData();

				var idExpediente=$("#modificacionExpediente").find('input[name="id"]').val();
              	var idTipoExpediente=$("#selTipoExpedienteMod").val();
              	var numeroExpediente=$("#numeroExpedienteMod").val();
              	var folios=$("#foliosMod").val();
              	var documentoParticular=$("#documentoParticularMod").val();
              	var apellidosParticular=$("#apellidosParticularMod").val();
              	var nombresParticular=$("#nombresParticularMod").val();
              	var idOrigen=$("#selOrigenMod").val();
              	var idSesion=$("#selSesionMod").val();
				var numeroSancion=$("#numeroSancion").val();
				var año=$("#añoIngresoMod").val();
				var numeros=[];
              	$("#tabla-numeros-mod > tbody > tr").each(function(){ 
                  	var numero = { 
                          			ente:$(this).find("td:eq(0)").html(), 
                              		numero:$(this).find("td:eq(1)").html(), 
                              		letra:$(this).find("td:eq(2)").html(), 
                              		año: $(this).find("td:eq(3)").html(), 
                              		folios:$(this).find("td:eq(4)").html(),
                              		cuerpos:$(this).find("td:eq(5)").html()
                              	  }; 
                	 numeros.push(numero);
                });

                var caratula=$("#caratulaMod").val();
                var archivos=$(form).find('[name="input-file-Mod"]')[0].files;

                var validacion='';

                formData.append('idExpediente',idExpediente);
            	
              	formData.append('idTipoExpediente',idTipoExpediente);
              	validacion+=((idTipoExpediente==0)?'<li>Debe seleccionar un tipo de expediente</li>':'');
              	
              	formData.append('numeroExpediente',numeroExpediente);
              	validacion+=((numeroExpediente.replace(/ /g, '').length==0)?'<li>El expediente debe tener un número</li>':'');
              	validacion+=((!$.isNumeric(numeroExpediente))?'<li>El número de expediente no puede contener letras ni espacios</li>':'');
              	
              	formData.append('folios',folios);
              	validacion+=((folios.replace(/ |\n/g, '').length==0)?'<li>Debe especificar la cantidad de folios</li>':'');
              	validacion+=((!$.isNumeric(folios))?'<li>la número de folios no puede contener letras ni espacios</li>':'');
              	
              	formData.append('documentoParticular',documentoParticular);
              	validacion+=((idTipoExpediente==3 && folios.replace(/ |\n/g, '').length!=0 && !$.isNumeric(documentoParticular))
                      		  ?'<li>la número de documento no puede contener letras ni espacios</li>':'');
				formData.append('apellidosParticular',apellidosParticular);
				validacion+=((idTipoExpediente==3 && apellidosParticular.replace(/ |\n/g, '').length==0)
							  ?'<li>Debe especificar un apellido para el demandante particular</li>':'');
				  
				formData.append('nombresParticular',nombresParticular);
				validacion+=((idTipoExpediente==3 && apellidosParticular.replace(/ |\n/g, '').length==0)
						  	  ?'<li>Debe especificar un nombre para el demandante particular</li>':'');
			  	  
				formData.append('idOrigen',idOrigen);
				validacion+=((idTipoExpediente==4 && idOrigen==0)
					  	  	  ?'<li>Debe especificar el origen del expediente</li>':'');
		  	  	  
				formData.append('numeros',JSON.stringify(numeros));
				validacion+=((idTipoExpediente==4 && numeros.length==0)
				  	  	  	  ?'<li>Debe especificar el/los numero/s de origen del expediente</li>':'');	
	  	  	  	  		
				formData.append('caratula',caratula);
				validacion+=((caratula.replace(/ |\n/g, '').length==0)
							  ?'<li>Debe especificar un texto para la caratula</li>':'');

				formData.append('año',año);
				validacion+=((año.replace(/ |\n/g, '').length==0)
						  	 ?'<li>Debe especificar un año para el expediente</li>':'');
				validacion+=((parseInt(año)>(new Date()).getFullYear())
					  	 	  ?'<li>El año del expediente no puede ser mayor que el actual</li>':'');

				formData.append('numeroSancion',numeroSancion);

				formData.append('idSesion',idSesion);
				validacion+=((idSesion==0)
				  		 	  ?'<li>Debe especificar una sesion para el expediente</li>':'');
				  
				$.each(archivos, function(i, archivo) {
                	formData.append('uploadedFiles-' + i, archivo);
            	});
				
	            if (validacion.length>0) 
				{
					validacion=((validacion.length>0)?'<strong>Validacion de Datos</strong><br><ul>'+
								validacion+'</ul>':'');
					toastr.error(validacion);
					$('#btn-Modificacion-expediente').prop("disabled", false);
					return false;
				}
				else{

	            	$.ajax({
		                async: true,
		                url: '{{ app.request.getBaseURL() }}'+'/api/expediente/update',
		                data: formData,
		                cache: false,
		                contentType: false,
		                processData: false,
		                type:  $(form).attr('method'),
	                success: function(data) {
	                    toastr.success(data);
						tabla.ajax.reload();
						$('#modificacionExpediente').modal('hide');
	                	},
	                complete:function(){
	                	$('#btn-Modificacion-expediente').prop("disabled", false);
	                },
	                error: function(jqXHR,textStatus,errorThrown ){
						toastr.error(jqXHR.responseText);
						}
	            	});
	            }
			});

			//--------------------------------------------------------------------------------------------------------------
			//-------------------------------------------NUEVO EXPEDIENTE----------------------------------------------------
			//--------------------------------------------------------------------------------------------------------------

			//EVENTO ABRIR MODAL NUEVO EXPEDIENTE
		    $('#nuevoExpediente').on('show.bs.modal', function () {

		    	$("#input-file").fileinput({
		    		language: "es",
	                showUpload: false,               
	                overwriteInitial: false,
	                maxFileSize: 10240,                
	            });
		    	
			  	if ($("#idProyecto").val()==0){
			  		$("#selTipoExpediente").val(0).change();
			  		$("#selTipoExpediente").prop( "disabled", false );
			  		mostrarTiposPara("no-proyectos");
			  	}
			  	else{ 
			  		$("#selTipoExpediente").prop( "disabled", true );
			  		$("#selTipoExpediente").val($("#idTipoExpediente").val());
			  		mostrarTiposPara("proyectos");
				}
			  	
			  	actualizarSesiones($("#selSesion"),0);
				mostrarOrigenParaNuevo($("#selTipoExpediente").val());
				$("#numeroExpediente").val('');
				$("#folios").val('');
				$("#añoIngreso").val((new Date()).getFullYear());
				$("#caratula").data("wysihtml5").editor.setValue('');

			});
			
			//EVENTO CERRAR MODAL NUEVO EXPEDIENTE
			$('#nuevoExpediente').on('hidden.bs.modal', function () {
				$('#input-file').fileinput('destroy');
				$("#idProyecto").val('');
				$("#idTipoProyecto").val(0);
				if ( $('#proyectosBusqueda').hasClass('in') )
					$('#proyectosBusqueda').modal('hide');
			});
			
			//GUARDAR ALTA EXPEDIENTE
			$("#alta").on('submit',function(e){
				
				e.preventDefault();
				$("#btn-nuevo-expediente").prop("disabled",true);
             	var form=$(e.target);
              	var formData=new FormData();
                var idProyecto=$("#nuevoExpediente").find('input[name="idProyecto"]').val();
              	var idTipoExpediente=$("#selTipoExpediente").val();
              	var numeroExpediente=$("#numeroExpediente").val();
              	var folios=$("#folios").val();
              	var documentoParticular=$("#documentoParticular").val();
              	var apellidosParticular=$("#apellidosParticular").val();
              	var nombresParticular=$("#nombresParticular").val();
              	var idOrigen=$("#selOrigen").val();
              	var idSesion=$("#selSesion").val();
              	var año=$("#añoIngreso").val();
				var numeros=[];
              	$("#tabla-numeros > tbody > tr").each(function(){ 
                  	var numero = { 
                          			ente:$(this).find("td:eq(0)").html(), 
                              		numero:$(this).find("td:eq(1)").html(), 
                              		letra:$(this).find("td:eq(2)").html(), 
                              		año: $(this).find("td:eq(3)").html(), 
                              		folios:$(this).find("td:eq(4)").html(),
                              		cuerpos:$(this).find("td:eq(5)").html()
                              	  }; 
                	 numeros.push(numero);
                });

                var caratula=$("#caratula").val();
                var archivos=$(form).find('[name="input-file"]')[0].files;

                var validacion='';

                formData.append('idProyecto',idProyecto);
              	formData.append('idTipoExpediente',idTipoExpediente);
              	validacion+=((idTipoExpediente==0)?'<li>Debe seleccionar un tipo de expediente</li>':'');
              	
              	formData.append('numeroExpediente',numeroExpediente);
              	validacion+=((numeroExpediente.replace(/ /g, '').length==0)?'<li>El expediente debe tener un número</li>':'');
              	validacion+=((!$.isNumeric(numeroExpediente))?'<li>El número de expediente no puede contener letras ni espacios</li>':'');
              	
              	formData.append('folios',folios);
              	validacion+=((folios.replace(/ |\n/g, '').length==0)?'<li>Debe especificar la cantidad de folios</li>':'');
              	validacion+=((!$.isNumeric(folios))?'<li>la número de folios no puede contener letras ni espacios</li>':'');
              	
              	formData.append('documentoParticular',documentoParticular);
              	validacion+=((idTipoExpediente==3 && folios.replace(/ |\n/g, '').length!=0 && !$.isNumeric(documentoParticular))
                      		  ?'<li>la número de documento no puede contener letras ni espacios</li>':'');
				formData.append('apellidosParticular',apellidosParticular);
				validacion+=((idTipoExpediente==3 && apellidosParticular.replace(/ |\n/g, '').length==0)
							  ?'<li>Debe especificar un apellido para el demandante particular</li>':'');
				  
				formData.append('nombresParticular',nombresParticular);
				validacion+=((idTipoExpediente==3 && apellidosParticular.replace(/ |\n/g, '').length==0)
						  	  ?'<li>Debe especificar un nombre para el demandante particular</li>':'');
			  	  
				formData.append('idOrigen',idOrigen);
				validacion+=((idTipoExpediente==4 && idOrigen==0)
					  	  	  ?'<li>Debe especificar el origen del expediente</li>':'');
		  	  	  
				formData.append('numeros',JSON.stringify(numeros));
				validacion+=((idTipoExpediente==4 && numeros.length==0)
				  	  	  	  ?'<li>Debe especificar el/los numero/s de origen del expediente</li>':'');	
	  	  	  	  		
				formData.append('caratula',caratula);
				validacion+=((caratula.replace(/ |\n/g, '').length==0)
							  ?'<li>Debe especificar un texto para la caratula</li>':'');

				formData.append('año',año);
				validacion+=((año.replace(/ |\n/g, '').length==0)
						  	 ?'<li>Debe especificar un año para el expediente</li>':'');
				validacion+=((parseInt(año)>(new Date()).getFullYear())
					  	 	  ?'<li>El año del expediente no puede ser mayor que el actual</li>':'');

				formData.append('idSesion',idSesion); 
				validacion+=((idSesion==0)
					  		 ?'<li>Debe especificar una sesion para el expediente</li>':'');
								  
				$.each(archivos, function(i, archivo) {
                	formData.append('uploadedFiles-' + i, archivo);
            	});
				
	            if (validacion.length>0) 
				{
					validacion=((validacion.length>0)?'<strong>Validacion de Datos</strong><br><ul>'+
								validacion+'</ul>':'');
					toastr.error(validacion);
					$('#btn-nuevo-expediente').prop("disabled", false);
					return false;
				}
				else{

	            	$.ajax({
		                async: true,
		                url: $(form).attr('action'),
		                data: formData,
		                cache: false,
		                contentType: false,
		                processData: false,
		                type: $(form).attr('method'),
	                success: function(data) {
	                    toastr.success(data);
						tabla.ajax.reload();
						$('#nuevoExpediente').modal('hide');
	                	},
	                complete: function(){
	                	$('#btn-nuevo-expediente').prop("disabled", false);
	                },
	                error: function(jqXHR,textStatus,errorThrown ){
						toastr.error(jqXHR.responseText);
						}
	            	});
	            }
			});

			//------------------------------------------------------------------------------------------------------------
			//--------------------------------------INGRESO DE PROYECTO---------------------------------------------------
			//------------------------------------------------------------------------------------------------------------

			//BOTON INGRESAR DE LA TABLA DE EXPEDIENTES
			$('#proyectos tbody').on( 'click', '.btn-ingresar', function () {
		        var data = tablaProyectos.row( $(this).parents('tr') ).data();
		        $("#nuevoExpediente").find('input[name="idProyecto"]').val(data[ "id" ]);
		        var tipoExpediente=data[ "tipo_proyecto"].tipo_expediente.id;
		        $("#nuevoExpediente").find('input[name="idTipoExpediente"]').val(tipoExpediente);
		        $("#nuevoExpediente").find('div[name="concejales"]').html(data[ "lista_concejales"]);
		        $("#nuevoExpediente").modal('show');
		    } );

			//EVENTO MOSTRAR DEL MODAL DE BUSQUEDA DE PROYECTOS
			$('#proyectosBusqueda').on('show.bs.modal', function () {

		    	tablaProyectos=$('#proyectos').DataTable({
					    			  "language": {
							              "infoEmpty": "Sin registros para mostrar",
							              "paginate": {
									          	"last": "Ultima Página",
									          	"first": "Primer página",
									          	"next": "Siguiente",
									          	"previous": "Anterior"
									       },
									       "search":"Búsqueda rápida",
									       "emptyTable": "Sin Datos",
									       "lengthMenu": 'Registros Listados <select class="form-control input-sm">'+
											             '<option value="10">10</option>'+
											             '<option value="20">20</option>'+
											             '<option value="30">30</option>'+
											             '<option value="40">40</option>'+
											             '<option value="50">50</option>'+
											             '<option value="-1">Todos</option>'+
											             '</select>',
											"loadingRecords": "Espere...cargando datos",
											"processing": "Procesando...",
											"sInfo": "Mostrando  _START_ a _END_ de _TOTAL_ registros",

						          	  },
								      "processing": false,
								      "ajax": {
										        "url": "api/proyecto/getByCriteria/busqueda-5/0",
						            			"dataSrc": '',
										    },
									  "columnDefs": [
											            {
											                "targets": [ 0 ],
											                "visible": false,
											                "searchable": false
											            },
											            {
											                "targets": [ 1 ],
											                "visible": false,
											                "searchable": false
											            },
											            {
												            "targets": [ 2 ],
												            "data": null,
												            "orderable":false,
												            "render": function(data, type, row){
												            	return "<button type='button' class='btn btn-primary btn-xs btn-ingresar'><span class='glyphicon glyphicon-check'></span></button>";
												            }
												        }
												       
									  ],
								      "columns": [
								      		{ "data": "id" },
								      		{ "data": "tipo_proyecto.tipo_expediente.id"},
								      		{ "data": "null","width":"12%"},
								      		{ "data": "tipo_proyecto.tipo_proyecto","width":"20%"},
								            { "data": "lista_concejales","className": "for-mobile","width":"70%" },
								        ],
								      "autoWidth":false,
								      "paging": true,
								      "lengthChange": true,
								      "searching": true,
								      "ordering": true,
								      "info": true,
							});

			});

			//EVENTO CERRAR DEL MODAL DE BUSQUEDA DE PROYECTOS
			$('#proyectosBusqueda').on('hidden.bs.modal', function () {
				tablaProyectos.destroy();
			});

			//------------------------------------------------------------------------------------------------------------
			//----------------------------------GIROS DE LOS EXPEDIENTES--------------------------------------------------
			//------------------------------------------------------------------------------------------------------------

			//EVENTO BOTON GIROS DE LA GRILLA
		    $('#registroExpediente tbody').on( 'click', '.btn-giros', function () {
		        var data = tabla.row( $(this).parents('tr') ).data();
		        $("#giros").find('input[name="idExpediente"]').val(data[ "id" ]);
		    } );
			
		  	//EVENTO ABRIR MODAL DE GIROS
			$('#giros').on('show.bs.modal', function () {

				tablaGiros=$('#tablaGiros').DataTable({
        	    			"language": {
        			              "infoEmpty": "Sin registros para mostrar",
        			              "paginate": {
        					          	"last": "Ultima Página",
        					          	"first": "Primer página",
        					          	"next": "Siguiente",
        					          	"previous": "Anterior"
        					       },
        					       "search":"Búsqueda rápida",
        					       "emptyTable": "Sin Datos",
        					       "lengthMenu": 'Registros Listados <select class="form-control input-sm">'+
        							             '<option value="10">10</option>'+
        							             '<option value="20">20</option>'+
        							             '<option value="30">30</option>'+
        							             '<option value="40">40</option>'+
        							             '<option value="50">50</option>'+
        							             '<option value="-1">Todos</option>'+
        							             '</select>',
        							"loadingRecords": "Espere...cargando datos",
        							"processing": "Procesando...",
        							"sInfo": "Mostrando  _START_ a _END_ de _TOTAL_ registros",
        
        		          	  },
        				      "processing": false,
        				      "ajax": {
        						        "url": "api/expediente/getGirosByExpediente_Id/"+traerIdParaMovimientos("giros"),
        		            			"dataSrc": '',
        						    },
        					  "columnDefs": [
        							            {
        							                "targets": [ 0 ],
        							                "visible": false,
        							                "searchable": false
        							            },
        							            {
        							                "targets": [ 1 ],
        							                "data": 'numero_remito',
        							                "visible": true,
        							                "orderable":true,
        							                "render": function(data, type, row){
        							                	return ((!data==0)?data:"");
										            },
        							                
        							            },
        							            
        					  ],
        				      "columns": [
        				      		{ "data": "id" },
        				      		{ "data": "numero_remito","width":"9%"},
        				      		{ "data": "origen","width":"15%"},
        				      		{ "data": "fecha_envio","width":"8%"},
        				      		{ "data": "destino","width":"15%"},
        				      		{ "data": "observacion","className": "for-mobile","width":"32%" },
        				      		{ "data": "fojas","width":"5%" },
        				            { "data": "fecha_recepcion","className": "for-mobile","width":"8%" },
        				            { "data": "remito_retorno","width":"8%"}
        				        ],
        				      "autoWidth":false,
        				      "paging": true,
        				      "lengthChange": true,
        				      "searching": true,
        				      "ordering": true,
        				      "info": true,
        			});

				
                				
			});

			//EVENTO CERRAR MODAL DE GIROS
			$('#giros').on('hidden.bs.modal', function () {
				tablaGiros.destroy();
			});

			//------------------------------------------------------------------------------------------------------------
			//-----------------------------SOLICITUD DE INFORMES LOS EXPEDIENTES------------------------------------------
			//------------------------------------------------------------------------------------------------------------

			//EVENTO BOTON INFORMES DE LA GRILLA
		    $('#registroExpediente tbody').on( 'click', '.btn-informes', function () {
		        var data = tabla.row( $(this).parents('tr') ).data();
		        $("#informes").find('input[name="idExpediente"]').val(data[ "id" ]);
		    } );
			
		  	//EVENTO ABRIR MODAL INFORMES
			$('#informes').on('show.bs.modal', function () {

				tablaInformes=$('#tablaInformes').DataTable({
                   			  	  "language": {
                		              "infoEmpty": "Sin registros para mostrar",
                		              "paginate": {
                				          	"last": "Ultima Página",
                				          	"first": "Primer página",
                				          	"next": "Siguiente",
                				          	"previous": "Anterior"
                				       },
                				       "search":"Búsqueda rápida",
                				       "emptyTable": "Sin Datos",
                				       "lengthMenu": 'Registros Listados <select class="form-control input-sm">'+
                						             '<option value="10">10</option>'+
                						             '<option value="20">20</option>'+
                						             '<option value="30">30</option>'+
                						             '<option value="40">40</option>'+
                						             '<option value="50">50</option>'+
                						             '<option value="-1">Todos</option>'+
                						             '</select>',
                						"loadingRecords": "Espere...cargando datos",
                						"processing": "Procesando...",
                						"sInfo": "Mostrando  _START_ a _END_ de _TOTAL_ registros",
                
                	          	  },
                			      "processing": false,
                			      "ajax": {
                					        "url": "api/expediente/getInformesByExpediente_Id/"+traerIdParaMovimientos("informes"),
                	            			"dataSrc": '',
                					    },
                				  "columnDefs": [
                						            {
                						                "targets": [ 0 ],
                						                "visible": false,
                						                "searchable": false
                						            },
                						            {
            							                "targets": [ 1 ],
            							                "data": 'numero_remito',
            							                "visible": true,
            							                "orderable":true,
            							                "render": function(data, type, row){
                        							                return ((!data==0)?data:"");
            										               },
                						            },
                						            {
            							                "targets": [ 6 ],
            							                "data": 'fecha_respuesta_formateada',
            							                "visible": true,
            							                "orderable":true,
            							                "render": function(data, type, row){
                							                
                    							                	if (("{{ app.user.rol.oficina is null}}" || "{{ app.user.rol.oficina.id }}"== "9" ) 
                        									            	 && data=="" && '{{ EXP_REPORT_RETURN is defined}}'){
                	    												return "<button type='button' title='Ingresar Fecha Respuesta' "+
                	    													   "class='btn btn-primary btn-xs btn-respuesta-informe'"+
                	    													   " data-toggle='modal' data-target='#respuestaInforme'>" +
                	    						             		  	  	   "<span class='glyphicon glyphicon-paperclip'></span></button>";
                									            	}
                    							                	else
                        							                	return data;
                							                		 
            										               },
                						            }
                							       
                				  ],
                			      "columns": [
                        			      		{ "data": "id" },
                        			      		{ "data": "numero_remito","width":"9%" },
                        			      		{ "data": "destino","width":"15%"},
                        			      		{ "data": "fecha_envio","width":"8%"},
                        			      		{ "data": "observacion","width":"46%"},
                        			      		{ "data": "fecha_recepcion","width":"8%"},
                        			      		{ "data": "fecha_respuesta_formateada","width":"8%"},
                        			      		{ "data": "remito_retorno","width":"8%"}
                            			     ],
                			      "autoWidth":false,
                			      "paging": true,
                			      "lengthChange": true,
                			      "searching": true,
                			      "ordering": true,
                			      "info": true,
                		});			
			});

			//BOTON INGRESAR RESPUESTA DE LA GRILLA DE INFORMES
			$('#tablaInformes tbody').on( 'click', '.btn-respuesta-informe', function () {
				debugger;
		        var data = tablaInformes.row( $(this).parents('tr') ).data();
		        $("#respuestaInforme").find('input[name="idInforme"]').val(data[ "id" ]);
		        $("#respuestaInforme").find('input[name="numeroRemitoInforme"]').val("");
		        $("#respuestaInforme").find('input[name="fechaRespuesta"]').val("");
		        actualizarSesiones($("#selSesionRespuesta"),0);
		    } );

			//EVENTO CERRAR MODAL DE INFORMES
			$('#informes').on('hidden.bs.modal', function () {
				tablaInformes.destroy();
			});
				
			//BOTON GUARDAR RESPUESTA DE INFORME
			$("#btn-respuesta-informe").click(function(){

				$(this).prop("disabled", true);
				
				var validacion="";
				var formData=new FormData();
				debugger;
				var idInforme =$("#respuestaInforme").find('input[name="idInforme"]').val();
				var fecha=$("#respuestaInforme").find('input[name="fechaRespuesta"]').val();
				var numeroRemito=$("#respuestaInforme").find('input[name="numeroRemitoInforme"]').val();
				var	idSesion=$("#respuestaInforme").find('select[name="selSesionRespuesta"]').val();
								
				formData.append('idInforme',idInforme);
				formData.append('fecha',fecha);;
				validacion=((fecha=="") ?'<li>Debe seleccionar una fecha</li>':'');
				formData.append('numeroRemito',numeroRemito);
				validacion+=((numeroRemito.length==0)
						 	  ?'<li>Debe indicar un numero de remito</li>':'');
				formData.append('idSesion',idSesion)
				validacion+=((idSesion==0)
						 	  ?'<li>Debe seleccionar una sesión</li>':'');
				
                if (validacion.length>0) 
        		{
        			validacion=((validacion.length>0)?'<strong>Validacion de Datos</strong><br><ul>'+
        						validacion+'</ul>':'');
        			toastr.error(validacion);
        			$(this).prop("disabled", false);
        			return false;
        		}
        		else{
        
                	$.ajax({
                        async: true,
                        url: '{{ app.request.getBaseURL() }}' + '/api/expediente/updateRespuestaInforme' ,
                        data: formData,
                        cache: false,
                        contentType: false,
                        processData: false,
                        type: 'POST',
                    success: function(data) {
                        toastr.success(data);
                        tablaInformes.ajax.reload();
        				$('#respuestaInforme').modal('hide');
                    	},
                    complete: function(){
                    	$("#btn-respuesta-informe").prop("disabled", false);
                    },
                    error: function(jqXHR,textStatus,errorThrown ){
        				toastr.error(jqXHR.responseText);
        				}
                	});
                }
				
			});

			//------------------------------------------------------------------------------------------------------------
			//-------------------------------------------ALTA DE SESIÓN---------------------------------------------------
			//------------------------------------------------------------------------------------------------------------

			$("#modalSesion").on('show.bs.modal', function () {
				$("#selTipoSesion").val(0);
				$("#fecha").val("");
				$("#descripcion").val("");
			});

			$("#btn-guardar-sesion").click(function(){

				$(this).prop("disabled",true);
				var formData=new FormData();

				var control=$("#modalSesion").find('input[name="control"]').val();
				var idSesion=$("#modalSesion").find('input[name="id"]').val();
				var idTipoSesion=$("#selTipoSesion").val();
              	var fecha=$("#fecha").val();
              	var descripcion=$("#descripcion").val();
              	
                var validacion='';
                
                formData.append('idTipoSesion',idTipoSesion);
                validacion+=((idTipoSesion==0)?'<li>Debe seleccionar un tipo de sesion</li>':'');
            	
              	formData.append('fecha',fecha);
              	validacion+=((fecha=="")?'<li>Debe indicar una fecha para la sesión</li>':'');
                            	
              	formData.append('descripcion',descripcion);
              	validacion+=((descripcion.replace(/ |\n/g, '').length==0)
                      		 ?'<li>Debe especificar una descripción</li>':'');
            				  				
	            if (validacion.length>0) 
				{
					validacion=((validacion.length>0)?'<strong>Validacion de Datos</strong><br><ul>'+
								validacion+'</ul>':'');
					toastr.error(validacion);
					$(this).prop("disabled", false);
					return false;
				}
				else{

	            	$.ajax({
		                async: true,
		                url: '{{ app.request.getBaseURL() }}'+'/api/sesion/save',
		                data: formData,
		                cache: false,
		                contentType: false,
		                processData: false,
		                type:  'POST',
	                success: function(data) {
	                    toastr.success(data);
	                    actualizarSesiones($("#"+control),0);
						$('#modalSesion').modal('hide');
	                	},
	                complete:function(){
	                	$("#btn-guardar-sesion").prop("disabled", false);
	                },
	                error: function(jqXHR,textStatus,errorThrown ){
						toastr.error(jqXHR.responseText);
						}
	            	});
	            }
			});
			
		    //------------------------------------------------------------------------------------------------------------
			//---------------------------------INICIALIZACIÓN DE CONTROLES------------------------------------------------
			//------------------------------------------------------------------------------------------------------------

			$("#btn-nueva-sesion-alta").click(function(){
				$("#modalSesion").find('input[name="control"]').val("selSesion");
				$("#modalSesion").modal('show');
			});

			$("#btn-nueva-sesion-modificacion").click(function(){
				$("#modalSesion").find('input[name="control"]').val("selSesionMod");
				$("#modalSesion").modal('show');
			});
			
			$("#selTipoExpediente").change(function(){
				mostrarOrigenParaNuevo($(this).val());
			});

			$("#selTipoExpedienteMod").change(function(){
				mostrarOrigenParaEdicion($(this).val());
			});

			$('#input-file-Mod').on('filebatchselected', function(event, files) {
			    $.each(files,function(index,file){
			    	archivosASubir.push(file.name);
			    });
			});

			$('#input-file-Mod').on('filecleared', function(event) {
			   archivosASubir.length=0
			});

			$('#estadoFiltro').bootstrapToggle({
		      on:  'Activo',
		      off: 'Inactivo',
		      offstyle: 'primary',
		      onstyle: 'success',
		      width: "80px",
		      height: "35px"
		    });

			$(".busqueda").addClass('hidden');
			$("#selBusqueda").val("todo");
			$('#estadoFiltro').bootstrapToggle('disable');

			$("#selBusqueda").change(function(){

				var control=$(this).val();
				$(".busqueda").addClass('hidden');
				if(control!="todo")
					$("#"+control).removeClass('hidden');
				else{
					$("#busqueda-1").val("");
					$("#busqueda-2").val("0");
					$("#busqueda-3").val("");
					$("#busqueda-4").val("0");
				}
			});

			$("#btn-busqueda").click(function(){
				if($("#selBusqueda").val()!="todo" && criterio()!="" && criterio()!="0")
				{
					tabla.ajax.url("api/expediente/getByCriteria/"+tipoCriterio()+"/"+criterio()).load();
					$(".filtro").prop('disabled',true);
					$('#estadoFiltro').bootstrapToggle('enable');
					$("#estadoFiltro").bootstrapToggle('on');
				}
			});

			$('#estadoFiltro').change(function() {
				if(!$(this).is(':checked')){
					$(".filtro").prop('disabled',false);
					$("#selBusqueda").val("todo").change();
					$(".filtro").prop('disabled',false);
					tabla.ajax.url("api/expediente/getByCriteria/"+tipoCriterio()+"/"+criterio()).load();
					$(this).bootstrapToggle('disable');
					
				}
			});

			$(".text-area-caratula").wysihtml5({
				toolbar: {
				    "image": false,
					"size": "xs",
				},
			});

			$("#selAutoresPrev").select2({
			  language: "es",
			  allowClear: true,
			  minimumInputLength: -1,
			  theme: "bootstrap",
			});

			$(".campo-fecha").datetimepicker({
		    	locale: 'es',
		    	format:'DD/MM/YYYY',
		    	maxDate : 'now'
		    });

			$(".campo-fecha-futura").datetimepicker({
		    	locale: 'es',
		    	format:'DD/MM/YYYY',
		    	minDate : 'now'
		    });

		    $(".es-numero").on('keypress',function(event){
			    console.log(event.which);
		    	if ( ( event.which < 48 || event.which > 57 ) &&  
				      event.which != 0  &&
				      event.which != 8) 
				 {
		    		return false;
		    	 }
			});

			$(".es-letra").on('keypress',function(event){
			    var regexpr=/[A-Za-z]/;
		    	if (!regexpr.test(event.key))
				 {
		    		return false;
		    	 }
			});
	});
	</script>
	<section class="content-header">
		<div class="row pull-right">
			<ol class="breadcrumb">
		        <li><a href="#"><i class="fa fa-dashboard"></i> Principal</a></li>
		        <li>Expedientes</li>
		        <li class="active">Gestión Expedientes</li>
		        
		    </ol>
		</div>
		<hr>
		<div class="row">
			<div class="col-md-3">
				<h2>
			        Gestión Expedientes
			    </h2>
			</div>
			<div class="col-md-6 col-md-offset-3">
				<nav class="navbar navbar-default">
					<div class="container-fluid">
						<div class="navbar-header">
							<label class="navbar-brand">Filtro</label>
						</div>
						<div class="collapse navbar-collapse">
							<div>
								<form class="navbar-form navbar-left">
									<div class="form-group">
										<div class="form-group text-center">
											<input type="checkbox" id="estadoFiltro" data-size="normal"/>
							        	</div> 
										<button type="button" class="btn btn-primary filtro" id="btn-busqueda">Aplicar</button>
										<select class="form-control filtro" id="selBusqueda">
											<option value="todo">Todo</option>
											<option value="busqueda-1">Autor</option>
											<option value="busqueda-2">Estado</option>
											<option value="busqueda-3">Número Expediente</option>
											<option value="busqueda-4">Tipo de Expediente</option>
											<option value="busqueda-5">Nombres Particular</option>
											<option value="busqueda-6">DNI Particular</option>
										</select>
										<input class="form-control busqueda hidden filtro" id="busqueda-1"/>
										<select class="form-control busqueda hidden filtro" id="busqueda-2">
											<option value="0">Seleccione Estado</option>
											{% for estado in estados %}
								                <option value="{{ estado.id }}">{{ estado.estadoExpediente }}</option>
								            {% endfor %}
										</select>
										<input class="form-control busqueda hidden filtro" id="busqueda-3"/>
										<select class="form-control busqueda hidden filtro" id="busqueda-4">
											<option value="0">Seleccione Tipo</option>
											{% for tipo in tipos %}
								                <option value="{{ tipo.id }}">{{ tipo.tipoExpediente }} - ({{ tipo.letra }})</option>
								            {% endfor %}
										</select>
										<input class="form-control busqueda hidden filtro" id="busqueda-5"/>
										<input class="form-control busqueda hidden filtro" id="busqueda-6"/>
									</div>
								</form>
							</div>
						</div>
					</div>
				</nav>
				
			</div>
	    </div>
	   
	</section>
	<section class="content">
	  	<div class="row">
	    	<div class="col-xs-12">
              	<table id="registroExpediente" class="table table-striped">
	                <thead>
	                	<tr>
	                		<th>id</th>
	                		<th>
	                			<!-- <div class="text-center"> -->
    	                			<div class="btn-group">
    	                				{% if EXP_NEW is defined %}
    		                			<button type="button" title="Agregar expediente"class="btn btn-primary btn-xs" data-toggle="modal" data-target="#nuevoExpediente">
    							    			<span class="glyphicon glyphicon-plus"></span>
    							    	</button>
    							    	{% endif %}
    							    	{% if EXP_ADD is defined %}
    							    	<button type="button" title="Ingresar proyecto"class="btn btn-primary btn-xs" data-toggle="modal" data-target="#proyectosBusqueda">
    							    			<span class="glyphicon glyphicon-download-alt"></span>
    							    	</button>
    							    	{% endif %}
    							    </div>
    							<!-- </div> -->
						    </th>	
						    <th>Numero</th>
			                <th>Tipo</th>
			                <th>F. Ing</th>
			                <th>F. Mod</th>
			                <th>Oficina Actual</th>
			                <th>Caratula</th>
	                	</tr>
	                </thead>
	                <tbody>
	                </tbody>
               	</table>     
	        </div> {# col #}
	    </div> {# row #}

	    <div id="proyectosBusqueda" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false"> 
		 	<div class="modal-dialog modal-lg">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Proyectos no entrados</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				  
			        	<div class="row">
			        		<div class="col-md-12">
					        	<div class="form-group">
					        		<table class="table " id="proyectos">
					        			<thead>
						                	<tr>
						                		<th>id</th>
						                		<th>idTipoProyecto</th>
						                		<th>Ingresar</th>
								                <th>Tipo</th>
								                <th>Autores</th>
						                	</tr>
						                </thead>
						                <tbody>
						                </tbody>
						            </table>
					        	</div>
					        </div>
					    </div>
						
					</div>
					<div class="modal-footer" style="background-color:#ecf0f5">  	
				        <hr>
				        <div class="row">
				        	<div class="col-md-12">
				        		<div class="text-center">
					    			<div class="btn-group">
							        	<button type="button" class="btn btn-info" data-dismiss="modal">Cerrar</button>
							        </div>
						        </div>
						    </div>
			    		</div>
				     </div>
			    </div>
		  	</div>
		</div>
		<div id="numeroExterno" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false" >
			<div class="modal-dialog">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Expediente Externo</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				    	<form role="form">
				    		<input type="hidden" id="tabla-destino" name="tabla-destino">
				    		<input type="hidden" id="idModal" name="idModal">
				    		<div class="row">
				    			<div class="col-md-10 col-md-offset-1">
				    				<div class="row">
        				    			<div class="col-md-12">
                				    		<div class="row">
                				    			<div class="col-md-2 col-nopadding">
                        				    		<div class="form-group text-center">
                        				    			<label for="enteOrigen">Ente</label>
                        				    			<input type="text" maxlength="4" 
                        				    			 class="form-control text-center es-numero" id="enteOrigen" name="enteOrigen">
                        				    		</div>
                        				    	</div>
                        				    	<div class="col-md-4 col-nopadding">
                        				    		<div class="form-group text-center">
                        				    			<label for="numeroOrigen">Numero</label>
                        				    			<input type="text" maxlength="8" 
                        				    			 class="form-control text-center es-numero" id="numeroOrigen" name="numeroOrigen">
                        				    		</div>
                        				    	</div>
                        				    	<div class="col-md-1 col-nopadding">
                        				    		<div class="form-group text-center">
                        				    			<label for="letraOrigen">Letra</label>
                        				    			<input type="text" maxlength="1" 
                        				    			 class="form-control text-center es-letra" id="letraOrigen" name="letraOrigen">
                        				    		</div>
                        				    	</div>
                        				    	<div class="col-md-2 col-nopadding">
                        				    		<div class="form-group text-center">
                        				    			<label for="añoOrigen">Año</label>
                        				    			<input type="text" maxlength="4" 
                        				    			 class="form-control text-center es-numero" id="añoOrigen" name="añoOrigen">
                        				    		</div>
                        				    	</div>
                        				    	<div class="col-md-2 col-nopadding">
                        				    		<div class="form-group text-center">
                        				    			<label for="foliosOrigen">Folios</label>
                        				    			<input type="text" maxlength="3" 
                        				    			 class="form-control text-center es-numero" id="foliosOrigen" name="foliosOrigen">
                        				    		</div>
                        				    	</div>
                        				    	<div class="col-md-1 col-nopadding">
                        				    		<div class="form-group text-center">
                        				    			<label for="cuerpos">Cuerpos</label>
                        				    			<input type="text" maxlength="2" 
                        				    			 class="form-control text-center es-numero" id="cuerpos" name="cuerpos">
                        				    		</div>
                        				    	</div>
                        				    </div>
                        				</div>
                        			</div>
                        		</div>
                			</div>
    				    	<div class="row">
    				    		<div class="col-md-12">
					        		<div class="text-center">
						    			<div class="btn-group">
								        	<button type="button" class="btn btn-info" data-dismiss="modal">Cancelar</button>
				       			 			<button type="button" class="btn btn-primary" id="btn-agregar-numero">Agregar</button>
								        </div>
							        </div>
							    </div>
    				    	</div>
				    	</form>
				    </div>
				</div>
			</div>
		</div>
		<div id="retornoExterno" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false" >
			<div class="modal-dialog modal-sm>
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Retorno Expediente</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				    	<form role="form">
				    		<legend class="text-center" id="leyenda-retorno"></legend>
				    		<input type="hidden" id="idExpediente" name="idExpediente">
				    		<div class="row">
				    			<!-- <div class="col-md-12">	 -->
    				    			<div class="col-md-4" id="col-folios">
    				    			</div>
    				    			<div class="col-md-4">
    				    				<div class="form-group">
        				    				<label for="fechaRetorno">Fecha Ingreso</label>
        				    				<input type="text" class="form-control text-center campo-fecha"
        				    					   id="fechaRetorno" name="fechaRetorno">
        				    			</div>
    				    			</div>
    				    			<div class="col-md-4">
    				    				<div class="form-group">
        				    				<label for="numeroRemitoRetorno">N° Remito</label>
        				    				<input type="text" class="form-control text-center es-numero"
        				    					   id="numeroRemitoRetorno" name="numeroRemitoRetorno">
        				    			</div>
    				    			</div>
    				    		<!-- </div> -->
                			</div>
                			<hr>
    				    	<div class="row">
    				    		<div class="col-md-12">
					        		<div class="text-center">
						    			<div class="btn-group">
								        	<button type="button" class="btn btn-info" data-dismiss="modal">Cancelar</button>
				       			 			<button type="button" class="btn btn-primary" id="btn-retorno-hcd">Aceptar</button>
								        </div>
							        </div>
							    </div>
    				    	</div>
				    	</form>
				    </div>
				</div>
			</div>
		</div>
		<div id="respuestaInforme" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false" >
			<div class="modal-dialog">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Respuesta Informe</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				    	<form role="form">
				    		<input type="hidden" id="idInforme" name="idInforme">
				    		<div class="row">
				    			<div class="col-md-4">
				    				<div class="form-group">
    				    				<label for="fechaRespuesta">Fecha Respuesta</label>
    				    				<input type="text" class="form-control text-center campo-fecha"
    				    					   id="fechaRespuesta" name="fechaRespuesta">
    				    			</div>
				    			</div>
				    			<div class="col-md-4">
				    				<div class="form-group">
    				    				<label for="numeroRemitoInforme">N° Remito</label>
    				    				<input type="text" class="form-control text-center es-numero"
    				    					   id="numeroRemitoInforme" name="numeroRemitoInforme">
    				    			</div>
				    			</div>
				    			<div class="col-md-4">
				    				<div class="form-group">
				    					<label for="selSesionRespuesta">Sesión</label>
				    					<select class="form-control" id="selSesionRespuesta" 
					        					name="selSesionRespuesta">
					        					<option value="0">Seleccione Sesion</option>
					        			</select>
				    				</div>
				    			</div>
                			</div>
                			<hr>
    				    	<div class="row">
    				    		<div class="col-md-12">
					        		<div class="text-center">
						    			<div class="btn-group">
								        	<button type="button" class="btn btn-info" data-dismiss="modal">Cancelar</button>
				       			 			<button type="button" class="btn btn-primary" id="btn-respuesta-informe">Aceptar</button>
								        </div>
							        </div>
							    </div>
    				    	</div>
				    	</form>
				    </div>
				</div>
			</div>
		</div>
	   	<div id="nuevoExpediente" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false" >
		 	<div class="modal-dialog modal-xl">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Nuevo Expediente</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				        <form id="alta" action="api/expediente/create" method="POST">
				        	<input type="hidden" id="idProyecto" name="idProyecto" value="0">
				        	<input type="hidden" id="idTipoExpediente" name="idTipoExpediente" value="0">
				        	<div class="row">
			        			<div class="col-md-5">
		        					<div class="row">
		        						{# DATOS EXP. HCD #}
		        						<div class="col-md-5">
								        	<div class="form-group">
								        		<label for="selTipoExpediente">Tipo</label>
								        		<select class="form-control" id="selTipoExpediente" 
								        				name="selTipoExpediente">
								        			<option value="0">Seleccione Tipo</option>
								        			{% for tipo in tipos %}
										                <option value="{{ tipo.id }}" class="opcion-{{ tipo.letra }}">{{ tipo.tipoExpediente }} - ({{ tipo.letra }})</option>
										            {% endfor %}
								        		</select>
								        	</div>
								       	</div>
								       	<div class="col-md-3">
							        		<div class="form-group">
								        		<label for="numeroExpediente">N° Exp. HCD</label>
								        		<input type="text" class="form-control es-numero" id="numeroExpediente"
								        			   name="numeroExpediente" placeholder="N° Expediente">
								        	</div>
								        </div>
								        <div class="col-md-2">
    								        <div class="form-group">
								        		<label for="folios">Folios HCD</label>
								        		<input type="text" class="form-control es-numero" id="folios"
								        			   name="folios" placeholder="Folios">
								        	</div>
								        </div>
								        <div class="col-md-2">
    								        <div class="form-group">
								        		<label for="añoIngreso">Año</label>
								        		<input type="text" class="form-control es-numero" id="añoIngreso"
								        			   name="añoIngreso" placeholder="Año" maxlength="4">
								        	</div>
								        </div>
								        {# DATOS EXP. HCD #}
							        </div>
							        <div class="row">
							        	<div class="col-md-5">
							        		<div class="form-group">
							        			<label for="selSesion">Sesion</label>
							        		 	<div class="input-group">
                                                  	<select class="form-control" id="selSesion" 
								        					name="selSesion">
								        					<option value="0">Seleccione Sesion</option>
								        			</select>
                                                  	<span class="input-group-btn">
                                                    	<button class="btn btn-primary" type="button"
                                                    			id="btn-nueva-sesion-alta" >Agregar</button>
                                                  	</span>
                                                </div>
								        		<!-- <label for="selSesion">Sesion</label>
								        		<select class="form-control" id="selSesion" 
								        				name="selSesion">
								        			<option value="0">Seleccione Sesion</option>
								        		</select> -->
								        	</div>
							        	</div>
							        </div>
						        </div>
						        <div class="col-md-7">
						        	<div class="row hidden expediente-particular">
						        		{# DATOS DEMANDANTE EXP.PARTICULAR #}
						        		<div class="col-md-2">
							        		<div class="form-group">
								        		<label for="documentoParticular">Documento</label>
						        				<input type="text" id="documentoParticular" name="documentoParticular"
						        				 class="form-control text-center es-numero" maxlength="8">
						        			</div>
							        	</div>
							        	<div class="col-md-5">
							        		<div class="form-group">
								        		<label for="apellidosParticular">Apellidos</label>
						        				<input type="text" id="apellidosParticular" name="apellidosParticular"
						        				 class="form-control">
						        			</div>
							        	</div>
							        	<div class="col-md-5">
						        			<div class="form-group">
								        		<label for="nombresParticular">Nombres</label>
						        				<input type="text" id="nombresParticular" name="nombresParticular"
						        				 class="form-control">
						        			</div>
							        	</div>	
							        	{# DATOS DEMANDANTE EXP. PARTICULAR #}
							        </div>
							        <div class="row hidden proyecto-concejales">
							        	{# DATOS AUTORES EXP. LEGISLATIVO #}
							        	<div class="col-md-12">
							        		<div class="form-group">
											    <label for="concejales">Concejales</label>
											    <div class="scrollable-div" id="concejales" name="concejales"></div>
											</div>
										</div>
										{# DATOS AUTORES EXP. LEGISLATIVO #}
							        </div>
							        <div class="row hidden ente-externo">
							        	{# DATOS AUTORES EXP. DEL EJECUTIVO #}
							        	<div class="col-md-4">
							        		<div class="form-group">
    						        			<label for="selOrigen">Origen Externo</label>
    						        			<select class="form-control" id="selOrigen" name="selOrigen">
    						        				<option value="0">Seleccione origen</option>
    						        				{% for oficina in oficinasExternas %}
    									                <option value="{{ oficina.id }}">{{ oficina.oficina|capitalize }}</option>
    									            {% endfor %}
    						        			</select>
    						        		</div>
							        	</div>
							        	<div class="col-md-8">
							        		<div class="row">
        						        		<div class="col-md-6">
        						        			<label>Números Externos</label>
        						        		</div>
        						        		<div class="col-md-6">
        						        			<button type="button" class="btn btn-sm btn-primary pull-right" 
        						        			 onclick="abrirModalExternos('nuevoExpediente','tabla-numeros');">
        						        			 Agregar Número</button>
        						        		</div>
        						        	</div>
        						        	<div class="row">
        						        		<div class="col-md-12">
                						        	<table class="table table-striped table-fixed" id="tabla-numeros">
                						        		<thead><th style="width:15%">Ente</th>
                						        			   <th style="width:20%">Numero</th>
                						        			   <th style="width:10%">Letra</th>
                						        			   <th style="width:15%">Año</th>
                						        			   <th style="width:15%">Folios</th>
                						        			   <th style="width:15%">Cuerpos</th>
                						        			   <th style="width:10%"></th>
                						        		</thead>
                						        		<tbody>
                						        		</tbody>
                						        	</table>
                						        </div>
                                    		</div>
							        	</div>
							        	{# DATOS AUTORES EXP. DEL EJECUTIVO #}
							        </div>
						        </div>  
				        	</div>
				        	<div class="row">
				        		<div class="col-md-5">
					        		<div class="form-group">
						        		<label for="caratula">Caratula</label>
							        	<textarea class="form-control text-area-caratula" 
							        	id="caratula" name="caratula" placeholder="Caratula"></textarea>
							        </div>
						        </div>
						        <div class="col-md-7">
    					        	<div class="form-group">
    					        		<label for="input-file">Archivos</label>
    						        	<input id="input-file" accept="image/*,application/pdf" name="input-file" type="file"
    						        		   multiple class="file-loading">
    					        	</div>
						        </div>
					        </div>
					         <div class="row">
					        	<div class="col-md-12">
					        		<div class="text-center">
						    			<div class="btn-group">
								        	<button type="button" class="btn btn-info" data-dismiss="modal">Cancelar</button>
				       			 			<button type="submit" class="btn btn-primary" id="btn-alta-expediente">Guardar</button>
								        </div>
							        </div>
							    </div>
				    		</div>					        
				        </form>
				     </div>
			    </div>
		  	</div>
		</div>
		<div id="modificacionExpediente" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false" >
		 	<div class="modal-dialog modal-xl">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Modificación Expediente</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				        <form id="modificacion" action="/api/expediente/update" method="POST">
				        	<input type="hidden" id="id" name="id">
				        	<div class="row">
				        		<div class="col-md-5">
				        			<div class="row">
				        				<div class="col-md-5">
    								    {# DATOS EXP. HCD #}
								        	<div class="form-group">
								        		<label for="selTipoExpedienteMod">Tipo</label>
								        		<select class="form-control" id="selTipoExpedienteMod" 
								        				name="selTipoExpedienteMod">
								        			<option value="0">Seleccione Tipo</option>
								        			{% for tipo in tipos %}
										                <option value="{{ tipo.id }}" class="opcion-{{ tipo.letra }}">{{ tipo.tipoExpediente }} - ({{ tipo.letra }})</option>
										            {% endfor %}
								        		</select>
								        	</div>
								        </div>
							        	<div class="col-md-3">
								        	<div class="form-group">
								        		<label for="numeroExpedienteMod">N° Exp. HCD</label>
								        		<input type="text" class="form-control es-numero" id="numeroExpedienteMod"
								        			   name="numeroExpedienteMod" placeholder="N° Expediente">
								        	</div>
								        </div>
								        <div class="col-md-2">
								        	<div class="form-group">
								        		<label for="foliosMod">Folios HCD</label>
								        		<input type="text" class="form-control es-numero" id="foliosMod"
								        			   name="foliosMod" placeholder="Cantidad Folios">
								        	</div>
								        </div>
								        <div class="col-md-2">
    								        <div class="form-group">
								        		<label for="añoIngresoMod">Año</label>
								        		<input type="text" class="form-control es-numero" id="añoIngresoMod"
								        			   name="añoIngresoMod" placeholder="Año" maxlength="4">
								        	</div>
								        </div>
								        {# DATOS EXP. HCD #}		
								    </div>
								    <div class="row">
							        	<div class="col-md-5">
							        		<div class="form-group">
							        			<label for="selSesionMod">Sesion</label>
							        		 	<div class="input-group">
                                                  	<select class="form-control" id="selSesionMod" 
								        					name="selSesionMod">
								        					<option value="0">Seleccione Sesion</option>
								        			</select>
                                                  	<span class="input-group-btn">
                                                    	<button class="btn btn-primary" type="button"
                                                    			id="btn-nueva-sesion-modificacion" >Agregar</button>
                                                  	</span>
                                                </div>
								        	</div>
							        	</div>
							        	<div class="col-md-4">
							        		<div class="form-group">
								        		<label for="numerosancionMod">N° Sanción</label>
								        		<input type="text" class="form-control es-numero" id="numerosancionMod"
								        			   name="numerosancionMod" placeholder="N° Sancion">
								        	</div>
								        </div>
							        </div>
						        </div>
						        <div class="col-md-7">
						        	<div class="row hidden expediente-particular">
						        		{# DATOS DEMANDANTE EXP.PARTICULAR #}
						        		<div class="col-md-2">
							        		<div class="form-group">
								        		<label for="documentoParticularMod">Documento</label>
						        				<input type="text" id="documentoParticularMod" name="documentoParticularMod"
						        				 class="form-control text-center es-numero" maxlength="8">
						        			</div>
							        	</div>
							        	<div class="col-md-5">
							        		<div class="form-group">
								        		<label for="apellidosParticularMod">Apellidos</label>
						        				<input type="text" id="apellidosParticularMod" name="apellidosParticularMod"
						        				 class="form-control">
						        			</div>
							        	</div>
							        	<div class="col-md-5">
						        			<div class="form-group">
								        		<label for="nombresParticularMod">Nombres</label>
						        				<input type="text" id="nombresParticularMod" name="nombresParticularMod"
						        				 class="form-control">
						        			</div>
							        	</div>	
							        	{# DATOS DEMANDANTE EXP. PARTICULAR #}
							        </div>
							        <div class="row hidden proyecto-concejales">
							        	{# DATOS AUTORES EXP. LEGISLATIVO #}
							        	<div class="col-md-12">
							        		<div class="form-group">
											    <label for="concejalesMod">Concejales</label>
											    <div class="scrollable-div" id="concejalesMod" name="concejalesMod"></div>
											</div>
										</div>
										{# DATOS AUTORES EXP. LEGISLATIVO #}
							        </div>
							        <div class="row hidden ente-externo">
							        	{# DATOS AUTORES EXP. DEL EJECUTIVO #}
							        	<div class="col-md-5">
							        		<div class="form-group">
    						        			<label for="selOrigenMod">Origen Externo</label>
    						        			<select class="form-control" id="selOrigenMod" name="selOrigenMod">
    						        				<option value="0">Seleccione origen</option>
    						        				{% for oficina in oficinasExternas %}
    									                <option value="{{ oficina.id }}">{{ oficina.oficina|capitalize }}</option>
    									            {% endfor %}
    						        			</select>
    						        		</div>
							        	</div>
							        	<div class="col-md-7">
							        		<div class="row">
        						        		<div class="col-md-6">
        						        			<label>Números Externos</label>
        						        		</div>
        						        		<div class="col-md-6">
        						        			<button type="button" class="btn btn-sm btn-primary pull-right" 
        						        			 onclick="abrirModalExternos('modificacionExpediente','tabla-numeros-mod');">
        						        			 Agregar Número</button>
        						        		</div>
        						        	</div>
        						        	<div class="row">
        						        		<div class="col-md-12">
                						        	<table class="table table-striped table-fixed" id="tabla-numeros-mod">
                						        		<thead>
                						        			<th style="width:15%">Ente</th>
                						        			<th style="width:20%">Numero</th>
                						        			<th style="width:10%">Letra</th>
                						        			<th	style="width:15%">Año</th>
                						        			<th style="width:15%">Folios</th>
                						        			<th style="width:15%">Cuerpos</th>
                						        			<th style="width:10%"></th>
                						        		</thead>
                						        		<tbody>
                						        		</tbody>
                						        	</table>
                						        </div>
                                    		</div>
							        	</div>
							        	{# DATOS AUTORES EXP. DEL EJECUTIVO #}
							        </div>
						        </div>  
						 	</div>
						 	<div class="row">
						 		<div class="col-md-5">
					        		<div class="form-group">
						        		<label for="caratulaMod">Caratula</label>
							        	<textarea class="form-control text-area-caratula" 
							        	id="caratulaMod" name="caratulaMod" placeholder="Caratula"></textarea>
							        </div>
							    </div>
						        <div class="col-md-7">
						        	<div class="form-group">
						        		<label for="input-file-Mod">Archivos</label>
							        	<input id="input-file-Mod" accept="image/*,application/pdf" name="input-file-Mod" type="file" multiple class="file-loading">
						        	</div>
						        </div>
					        </div>
					        <div class="row">
					        	<div class="col-md-12">
					        		<div class="text-center">
						    			<div class="btn-group">
								        	<button type="button" class="btn btn-info" data-dismiss="modal">Cancelar</button>
				       			 			<button type="submit" class="btn btn-primary" id="btn-Modificacion-expediente">Modificar</button>
								        </div>
							        </div>
							    </div>
				    		</div>
				        </form>
				     </div>
			    </div>
		  	</div>
		</div>
	{# 	<div id="revistaExpediente" class="modal fade" role="dialog">
		 	<div class="modal-dialog modal-xl">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Revista Expediente</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				    	<input type="hidden" id="id" name="id">
			        	<div class="row">
			        		<div class="col-md-6">
			        			<div class="row">
			        				<div class="col-md-6">
							        	<div class="form-group">
							        		<label for="selTipoExpedientePrev">Tipo</label>
							        		<input class="form-control" readonly id="tipoExpedientePrev" 
							        				name="tipoExpedienteMod">
							        	</div>
							        </div>
						        	<div class="col-md-6">
							        	<div class="form-group">
							        		<label for="numeroExpedientePrev">Número Expediente</label>
							        		<input type="text" readOnly class="form-control" id="numeroExpedientePrev" name="numeroExpedientePrev" >
							        	</div>
							        </div>	
							    </div>
					        	<div class="row">
						        	<div class="col-md-12">
						        		<div class="form-group">
							        		<label for="cartulaPrev">Carátula</label>
								        	<div class="div-Preview" id="cartulaPrev" name="cartulaPrev"></div>
								        </div>
								    </div>
						        </div>
					        </div>
					        <div class="col-md-6">
					        	<div class="row">
					        		<div class="col-md-12">
							        	<div class="form-group">
							        		<label for="input-file-Prev">Archivos</label>
								        	<input id="input-file-Prev" name="input-file-Prev" type="file" multiple class="file-loading">
							        	</div>
							        </div>
						        </div>
					        </div>
				        </div>
				        <div class="row">
				        	<div class="col-md-12">
								<div class="form-group">
						        	<label for="selAutoresPrev">Autores</label>
						        	<select class="form-control" data-width="100%" readOnly multiple="multiple" id="selAutoresPrev" name="selAutoresPrev"></select>
						        </div>
					        </div>
				        </div>
				        <hr>
				        <div class="row">
				        	<div class="col-md-12">
				        		<div class="text-center">
					    			<div class="btn-group">
							        	<button type="button" class="btn btn-info" data-dismiss="modal">Cerrar</button>
							        </div>
						        </div>
						    </div>
			    		</div>
				     </div>
			    </div>
		  	</div>
		</div> #}
		<div id="informes" class="modal fade" role="dialog">
		 	<div class="modal-dialog modal-xl">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Informes (CH)</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				    	<input type="hidden" id="idExpediente" name="idExpediente">				    	
        				<div class="row">
        					<div class="col-md-6">
                				<h3>
                			        Informes (CH)
                			    </h3>
                			</div>
            			</div>
            			<br>
                		<div class="row">
                			<div class="col-md-12">
					        	<table class="table table-striped" id="tablaInformes">
					        		<thead>
					        			<th>id</th>
					        			<th title="Remito">Rto.</th>
					        			<th>Destino</th>
					        			<th title="Fecha Emisión">Fec. Em.</th>
					        			<th>Observación</th>
					        			<th title="Fecha de Recepción Remito">Fec. Recep.</th>
					        			<th title="Fecha Respuesta">Fec. Resp.</th>
					        			<th title="Remito Externo">Rem. Ext.</th>
					        		</thead>
					        		<tbody>
					        		</tbody>
					        	</table>
					        </div>
				        </div>
				        <hr>
				        <div class="row">
				        	<div class="col-md-12">
				        		<div class="text-center">
					    			<div class="btn-group">
							        	<button type="button" class="btn btn-info" data-dismiss="modal">Cerrar</button>
							        </div>
						        </div>
						    </div>
			    		</div>
				     </div>
			    </div>
		  	</div>
		</div>
		<div id="giros" class="modal fade" role="dialog">
		 	<div class="modal-dialog modal-xl"
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666	;color:#FFF">
		    			<button type="button" class="close" data-dismiss="modal">&times;</button>
		    			<h4 class="modal-title">Giros</h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				    	<input type="hidden" id="idExpediente" name="idExpediente">				   
    					<div class="row">
        					<div class="col-md-6">
                				<h3>
                			        Giros
                			    </h3>
                			</div>
            			</div>
            			<br>
            			<div class="row">
            				<div class="col-md-12">
					        	<table class="table table-striped" id="tablaGiros" width="100%">
					        		<thead>
					        			<th>id</th>
					        			<th title="Remito">Rto.</th>
					        			<th>Origen</th>
					        			<th title="Fecha de Envío Remito">Fec. Env.</th>
					        			<th>Destino</th>
					        			<th>Observación</th>
					        			<th>Fojas</th>
					        			<th title="Fecha de Recepción Remito">Fec. Recep.</th>
					        			<th title="Remito Externo">Rem. Ext.</th>
					        		</thead>
					        	</table>
				        	</div>
				        </div>       
				        <hr>
				        <div class="row">
				        	<div class="col-md-12">
				        		<div class="text-center">
					    			<div class="btn-group">
							        	<button type="button" class="btn btn-info" data-dismiss="modal">Cerrar</button>
							        </div>
						        </div>
						    </div>
			    		</div>
				     </div>
			    </div>
		  	</div>
		</div>
		<div id="modalSesion" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
		 	<div class="modal-dialog">
			    <!-- Modal content-->
			    <div class="modal-content">
				    <div class="modal-header" style="background-color:#666;color:#FFF">
				        <button type="button" class="close" data-dismiss="modal" >&times;</button>
				        <h4 class="modal-title" id="tituloModal"><strong>Nueva Sesión</strong></h4>
				    </div>
				    <div class="modal-body" style="background-color:#ecf0f5">
				        <form role="form">
				        	<input type="hidden" name="control" id="control">
				        	<div class="row">
				        		<div class="col-md-8">	
						        	<div class="form-group">
						        		<label for="selTipoSesion">TipoSesion</label>
						        		<select class="form-control" id="selTipoSesion" name="selTipoSesion">
						        			<option value="0">Seleccione Tipo</option>
						        			{% for tipoSesion in tiposSesion %}
						        				<option value="{{ tipoSesion.id }}">{{ tipoSesion.tipoSesion }} - ({{ tipoSesion.abreviacion }})</option>
						        			{% endfor %}
						        		</select>
						        	</div>
						        </div>
					        	<div class="col-md-4">	
						        	<div class="form-group">
						        		<label for="fecha">Fecha</label>
						        		<input type= "text" class="form-control input-sm campo-fecha-futura" id="fecha" name="fecha" 
						        			   placeholder="Fecha Sesion">
						        	</div>
						        </div>
							</div>
							<div class="row">
								<div class="col-md-12">
    								<div class="form-group">
    									<label for="descripcion">Descripción</label>
    									<input type="text" class="form-control" id="descripcion" name="descripcion">
    								</div>
    							</div>
							</div>
					        <hr>
					        <div class="row">
					        	<div class="text-center">
							        <div class="btn-group">
							        	<button type="button" class="btn btn-info" data-dismiss="modal">Cancelar</button>
						       			 <button type="button" class="btn btn-primary" id="btn-guardar-sesion">Guardar</button>
						        	</div>
						        </div>
					        </div>	
				        </form>
				     </div>
			    </div>
		  	</div>
		</div> 
	</section>
{% endblock %}